
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Part 1: R basics and Calculating Screening Values &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MOD1/Mod1_Fish';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Module 1: Monitoring fisheries for heavy metal contaminants" href="mod1_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/EFI_Logo-1.jpg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/EFI_Logo-1.jpg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome: Indigenous Environmental Data Science with R
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../contact.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learn_R.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kavi_intro.html">Story of K'avi code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environmental Justice Data Science Modules</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="mod1_intro.html">Module 1: Monitoring fisheries for heavy metal contaminants</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Part 1: R basics and Calculating Screening Values</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/rachtorr/IndigenousEnvDataSci.github.io/main?urlpath=lab/tree/./MOD1/Mod1_Fish.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/rachtorr/IndigenousEnvDataSci.github.io/blob/main/./MOD1/Mod1_Fish.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/rachtorr/IndigenousEnvDataSci.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/rachtorr/IndigenousEnvDataSci.github.io/issues/new?title=Issue%20on%20page%20%2FMOD1/Mod1_Fish.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/MOD1/Mod1_Fish.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Part 1: R basics and Calculating Screening Values</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-libraries">Loading libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-objects-in-r">Creating objects in R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-screening-values-for-mercury-in-fish">Calculating screening values for mercury in fish</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-vectors">Creating vectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-data-frame-from-vectors">Creating a data frame from vectors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-screening-value-vs-servings-per-week-with-ggplot">Visualizing Screening Value vs. Servings Per Week with ggplot</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="part-1-r-basics-and-calculating-screening-values">
<h1>Part 1: R basics and Calculating Screening Values<a class="headerlink" href="#part-1-r-basics-and-calculating-screening-values" title="Link to this heading">#</a></h1>
<p>Members of the K’avi have fished the waters on their land for many years to provide food for their community. To manage these waters, K’avi tribal fishery managers have been monitoring fish growth rates across the local water bodies in their community.</p>
<p>However, many members of the community have begun to experience health problems associated with heavy metal poisoning. Historically, a factory used to be located upstream of the riverways fished by the K’avi, and waste from this factory was dumped into the nearby waters. Tribal fishery managers are now concerned that members of the community are being exposed to heavy metals through the fish that have been caught in these waters. As a result, they now want to start recording the concentrations of methylmercury in the belly fat of fish in the area.</p>
<p>According to the <a class="reference external" href="https://www.fda.gov/food/environmental-contaminants-food/technical-information-development-fdaepa-advice-about-eating-fish-those-who-might-become-or-are">FDA</a> the safe limit for methylmercury in fish, or screening value, depends on how often fish is consumed, and can range from 0.15ug/g to 0.46ug/g. Above 0.46ug/g should be avoided! This module will explore data on fish size and amount of methylmercury, starting with R basics and learning about how to calculate safe levels of fish consumption.</p>
<section id="loading-libraries">
<h2>Loading libraries<a class="headerlink" href="#loading-libraries" title="Link to this heading">#</a></h2>
<p>To use different functions, we need to install and load packages. Think of functions as a tool, and a package as a toolbox. For this module we will bring in <a class="reference external" href="https://www.tidyverse.org/">tidyverse</a>, which is a collection of useful packages for data science.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load packages </span>
<span class="nf">if</span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="s">&quot;tidyverse&quot;</span><span class="p">))</span><span class="w"> </span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;tidyverse&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: tidyverse
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Attaching core tidyverse packages</span> ──────────────────────────────────────────────────────────────── tidyverse 2.0.0 ──
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">dplyr    </span> 1.1.4     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">readr    </span> 2.1.5
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">forcats  </span> 1.0.0     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">stringr  </span> 1.5.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">ggplot2  </span> 3.5.1     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tibble   </span> 3.2.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">lubridate</span> 1.9.3     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tidyr    </span> 1.3.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">purrr    </span> 1.0.2     
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Conflicts</span> ────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">filter()</span> masks <span class=" -Color -Color-Blue">stats</span>::filter()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">lag()</span>    masks <span class=" -Color -Color-Blue">stats</span>::lag()
<span class=" -Color -Color-Cyan">ℹ</span> Use the conflicted package (<span class=" -Color -Color-Blue">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-objects-in-r">
<h2>Creating objects in R<a class="headerlink" href="#creating-objects-in-r" title="Link to this heading">#</a></h2>
<p>We will work with different types of objects and data types, including numbers, characters, vectors, and data frames. Here we start with creating objects for the variables and parameters used to calculate the safe limit of fish consumption. According to the FDA, the screening value, or amount of safe fish consumption, depends on a person’s body weight and how often they consume the fish.</p>
<p>First, the variabls <code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">days_per_week</span></code> are set.</p>
<p>Once we create an object, we can use math or functions on it. Below we calculate <code class="docutils literal notranslate"><span class="pre">CR</span></code>, the mean daily consumption rate of the species of interest (g/d), based on the <code class="docutils literal notranslate"><span class="pre">days_per_week</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define variables</span>
<span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">160</span><span class="w"> </span><span class="c1"># lbs</span>
<span class="n">days_per_week</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c1"># days per week eating fish </span>

<span class="c1"># print the values </span>
<span class="nf">print</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">days_per_week</span><span class="p">)</span>

<span class="c1"># use days per week to calculate mean daily consumption rate </span>
<span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">110</span><span class="o">*</span><span class="n">days_per_week</span><span class="o">/</span><span class="m">7</span><span class="w"> </span>
<span class="nf">print</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 160
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 31.42857
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-screening-values-for-mercury-in-fish">
<h2>Calculating screening values for mercury in fish<a class="headerlink" href="#calculating-screening-values-for-mercury-in-fish" title="Link to this heading">#</a></h2>
<p>Below we use the <code class="docutils literal notranslate"><span class="pre">weight</span></code>, mean daily consumption rate <code class="docutils literal notranslate"><span class="pre">cr</span></code>, and the reference dose <code class="docutils literal notranslate"><span class="pre">RfD</span></code> to calculate the screening value, based on FDA recommendations. Because the equation requires body weight in kg, we multiply our body weight in lbs by 0.45.</p>
<p><span class="math notranslate nohighlight">\(SV = RfD*weight*0.45/CR\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create new object for the reference dose</span>
<span class="n">RfD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="c1"># ug mercury /kg body weight/day</span>

<span class="c1"># Calculate safe limit </span>
<span class="n">safe_limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RfD</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0.45</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">cr</span>

<span class="nf">print</span><span class="p">(</span><span class="n">safe_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 0.2290909
</pre></div>
</div>
</div>
</div>
<p>Try changing the value for <code class="docutils literal notranslate"><span class="pre">weight</span></code> or <code class="docutils literal notranslate"><span class="pre">days_per_week</span></code>, and rerunning the two code chunks above to see the new safe screening value.</p>
<section id="creating-vectors">
<h3>Creating vectors<a class="headerlink" href="#creating-vectors" title="Link to this heading">#</a></h3>
<p>Next we will create a vector, which is list of the same type of object, that can similarly be used in a function or equation. Below we have two vectors, <code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">servings</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create vectors </span>
<span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">140</span><span class="p">,</span><span class="w"> </span><span class="m">175</span><span class="p">,</span><span class="w"> </span><span class="m">200</span><span class="p">)</span>
<span class="n">servings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>

<span class="c1"># can print entire vector </span>
<span class="nf">print</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">servings</span><span class="p">)</span>

<span class="c1"># or a single value from a vector </span>
<span class="n">weight</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 140 175 200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 1 6 3
</pre></div>
</div>
<div class="output text_html">140</div></div>
</div>
</section>
<section id="creating-a-data-frame-from-vectors">
<h3>Creating a data frame from vectors<a class="headerlink" href="#creating-a-data-frame-from-vectors" title="Link to this heading">#</a></h3>
<p>Multiple vectors of the same length become columns in a data frame. Below we make a data frame named <code class="docutils literal notranslate"><span class="pre">sv_df</span></code>. When we preview it using the <code class="docutils literal notranslate"><span class="pre">head()</span></code> function, we can see it is comprised of two columns, with the same name as the vectors we created.</p>
<p>Inside a data frame, columns are referred to using <code class="docutils literal notranslate"><span class="pre">$</span></code>. We can also preview a single row, using brackets.</p>
<p>We then add a third column, where we apply the equation for the screening value to each row</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># create data frame with two columns - from the vectors weight, servings </span>
<span class="n">sv_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">servings</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">sv_df</span><span class="p">)</span><span class="w"> </span><span class="c1"># preview the entire data frame </span>

<span class="nf">head</span><span class="p">(</span><span class="n">sv_df</span><span class="o">$</span><span class="n">weight</span><span class="p">)</span><span class="w"> </span><span class="c1"># see the column weight </span>

<span class="c1"># Add column for screening value</span>
<span class="n">sv_df</span><span class="o">$</span><span class="n">screen_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RfD</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sv_df</span><span class="o">$</span><span class="n">weight</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0.45</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="m">110</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sv_df</span><span class="o">$</span><span class="n">serving</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">7</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">sv_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 3 × 2</caption>
<thead>
	<tr><th></th><th scope=col>weight</th><th scope=col>servings</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>140</td><td>1</td></tr>
	<tr><th scope=row>2</th><td>175</td><td>6</td></tr>
	<tr><th scope=row>3</th><td>200</td><td>3</td></tr>
</tbody>
</table>
</div><div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>140</li><li>175</li><li>200</li></ol>
</div><div class="output text_html"><table class="dataframe">
<caption>A data.frame: 3 × 3</caption>
<thead>
	<tr><th></th><th scope=col>weight</th><th scope=col>servings</th><th scope=col>screen_val</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>140</td><td>1</td><td>0.40090909</td></tr>
	<tr><th scope=row>2</th><td>175</td><td>6</td><td>0.08352273</td></tr>
	<tr><th scope=row>3</th><td>200</td><td>3</td><td>0.19090909</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="visualizing-screening-value-vs-servings-per-week-with-ggplot">
<h2>Visualizing Screening Value vs. Servings Per Week with ggplot<a class="headerlink" href="#visualizing-screening-value-vs-servings-per-week-with-ggplot" title="Link to this heading">#</a></h2>
<p>Above, we used <code class="docutils literal notranslate"><span class="pre">head()</span></code> to preview our data frame. For longer data frames this will print out the first 6 rows.</p>
<p>Another way to preview and explore data frames is to visualize it. Throughout this module, we will use <a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2</a>. This package was loaded with <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code>.</p>
<p>We will create a plot step by step, starting with running <code class="docutils literal notranslate"><span class="pre">ggplot()</span></code> with our dataframe as the input. We then add layers to it using a plus sign.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/7d6e16b1722538217a7c6eab626462e6666e9f1b95c1f5d7307cd6504be9fd54.png"><img alt="../_images/7d6e16b1722538217a7c6eab626462e6666e9f1b95c1f5d7307cd6504be9fd54.png" src="../_images/7d6e16b1722538217a7c6eab626462e6666e9f1b95c1f5d7307cd6504be9fd54.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<p>Starting with <code class="docutils literal notranslate"><span class="pre">ggplot()</span></code> created the plot, but we need to also include the variables we want to plot. We do this using <code class="docutils literal notranslate"><span class="pre">aes()</span></code> and then include the column name you want on the x-axis, and the column name for the y-axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">servings</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">screen_val</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/bdd44d3d74c85424b6be89a61e55ca15d82af6df063777cf4e6315d841a98d0d.png"><img alt="../_images/bdd44d3d74c85424b6be89a61e55ca15d82af6df063777cf4e6315d841a98d0d.png" src="../_images/bdd44d3d74c85424b6be89a61e55ca15d82af6df063777cf4e6315d841a98d0d.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<p>Next we need to assign a <code class="docutils literal notranslate"><span class="pre">geom</span></code> - this could be a scatter plot, line plot, or boxplot. We will start with plotting as columns, using <code class="docutils literal notranslate"><span class="pre">geom_col()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">servings</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">screen_val</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_col</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/df9609440192b8c0a13b0c7de4f95313515f824fd1a1dfc8578505938f6abfca.png"><img alt="../_images/df9609440192b8c0a13b0c7de4f95313515f824fd1a1dfc8578505938f6abfca.png" src="../_images/df9609440192b8c0a13b0c7de4f95313515f824fd1a1dfc8578505938f6abfca.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<p>Now we have a draft of our first plot! We can continue to add layers and change the settings to have the plot tell us more about our data, or to make it look nicer.</p>
<p>Variables can be included as colors - in this example we set the weight to <code class="docutils literal notranslate"><span class="pre">fill</span></code> which will fill in the column with a color gradient for our weight values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">servings</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">screen_val</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">weight</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_col</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/585dcca9e64747bf9c0198c3ccb18a12e3e7a8e8dd30bbb2fb66c2186614d65c.png"><img alt="../_images/585dcca9e64747bf9c0198c3ccb18a12e3e7a8e8dd30bbb2fb66c2186614d65c.png" src="../_images/585dcca9e64747bf9c0198c3ccb18a12e3e7a8e8dd30bbb2fb66c2186614d65c.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<p>We can also change the <code class="docutils literal notranslate"><span class="pre">theme</span></code>, which alters the background and style of our plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">servings</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">screen_val</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">weight</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_col</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/933a5f4264e5dfef3a51af768261c7bfe69cb3d07d5870f6ed1c7403e2285fc3.png"><img alt="../_images/933a5f4264e5dfef3a51af768261c7bfe69cb3d07d5870f6ed1c7403e2285fc3.png" src="../_images/933a5f4264e5dfef3a51af768261c7bfe69cb3d07d5870f6ed1c7403e2285fc3.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<p>Finally we can add a title and change the labels to be more descriptive using <code class="docutils literal notranslate"><span class="pre">labs()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">servings</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">screen_val</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">weight</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_col</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;Servings per week&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;Screening value (ug/g)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Mercury Screening Value v. Servings per Week&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/f8573250fd3eee3b3de87f8defd6268574dc0efd7dc939d7302b1135298872d9.png"><img alt="../_images/f8573250fd3eee3b3de87f8defd6268574dc0efd7dc939d7302b1135298872d9.png" src="../_images/f8573250fd3eee3b3de87f8defd6268574dc0efd7dc939d7302b1135298872d9.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "rachtorr/IndigenousEnvDataSci.github.io",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./MOD1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mod1_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Module 1: Monitoring fisheries for heavy metal contaminants</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-libraries">Loading libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-objects-in-r">Creating objects in R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-screening-values-for-mercury-in-fish">Calculating screening values for mercury in fish</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-vectors">Creating vectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-data-frame-from-vectors">Creating a data frame from vectors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-screening-value-vs-servings-per-week-with-ggplot">Visualizing Screening Value vs. Servings Per Week with ggplot</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>