
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lesson 4: Plotting mercury concentrations with ggplot &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MOD1/Mod1_pt4';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lesson 5: Put it all together to explore the updated fish survey" href="Mod1_pt5.html" />
    <link rel="prev" title="Lesson 3: Calculating statistics" href="Mod1_pt3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/EFI_Logo-1.jpg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/EFI_Logo-1.jpg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome: Indigenous Environmental Data Science with R
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../contact.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learn_R.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kavi_intro.html">Story of K'avi code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environmental Justice Data Science Modules</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="mod1_intro.html">Module 1: Monitoring fisheries for heavy metal contaminants</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Mod1_pt1.html">Lesson 1: R basics and Calculating Screening Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mod1_pt2.html">Lesson 2: Loading and exploring data</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mod1_pt3.html">Lesson 3: Calculating statistics</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Lesson 4: Plotting mercury concentrations with ggplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mod1_pt5.html">Lesson 5: Put it all together to explore the updated fish survey</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/rachtorr/IndigenousEnvDataSci.github.io/main?urlpath=lab/tree/./MOD1/Mod1_pt4.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/rachtorr/IndigenousEnvDataSci.github.io/blob/main/./MOD1/Mod1_pt4.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/rachtorr/IndigenousEnvDataSci.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/rachtorr/IndigenousEnvDataSci.github.io/issues/new?title=Issue%20on%20page%20%2FMOD1/Mod1_pt4.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/MOD1/Mod1_pt4.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lesson 4: Plotting mercury concentrations with ggplot</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplots-distribution-of-1-variable">Boxplots: distribution of 1 variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scatterplots-relationship-between-2-variables">Scatterplots: relationship between 2 variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lesson-4-recap">Lesson 4 Recap</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lesson-4-plotting-mercury-concentrations-with-ggplot">
<h1>Lesson 4: Plotting mercury concentrations with ggplot<a class="headerlink" href="#lesson-4-plotting-mercury-concentrations-with-ggplot" title="Link to this heading">#</a></h1>
<p>We want to first visualize the amount of mercury in <em>all</em> the fish, or a distribution of the mercury data.</p>
<p>If you run the code chunk below, it will make a graph of all the 1998 mercury data. We want to see the distributions of mercury in the fish to learn how common it is for fish to have mercury levels above the EPA’s recommended safe level.</p>
<p>This code has a lot of details that we will work through later. For now, you can either just run the code chunk (by clicking the small green arrow in the upper right corner of the grey area), or you can explore the code line by line. We’ve provided some comments to help you out. <a class="reference external" href="https://images.datacamp.com/image/upload/v1666806657/Marketing/Blog/ggplot2_cheat_sheet.pdf">This cheatsheet</a> will also give you some tips.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload data </span>
<span class="n">fish_1998</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;fish_1998.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;,&#39;</span><span class="p">)</span>
<span class="c1"># load packages </span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w"> </span>
<span class="nf">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span>
<span class="c1"># change settings for plots to show up </span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>


<span class="c1">#For this plot, we want to see the distributions of mercury in the fish and how many of them are above the EPA&#39;s recommended levels</span>
<span class="c1">#ggplot is the function that we are using to create a plot. aes() is used to tell ggplot what we want to see on each axis, in this case x= &#39;fish&#39; and y= mercury. x=&quot;fish&quot; indicates that the x axis doesn&#39;t have a variable and is titled fish. This allows us to look at the variation in lengths of fish independent of another variable.</span>
<span class="nf">ggplot </span><span class="p">(</span><span class="n">fish_1998</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="s">&#39;fish&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="n">mercury</span><span class="p">))</span><span class="o">+</span>
<span class="c1">#Since ggplot is just a function to create plots, we need to further specify what kind of plot it should create. We can do this by using the geom_jitter function, which will create the jitter plot seen below. We can also add a few more parameters to the graph, such as changing the width of the points (width = 0.1).</span>
<span class="c1">#The jitter plot is a variation on the scatterplot, but it separates the data so that we can distinguish how many points are above the unsafe mercury level. To see the difference, try geom_point() and then geom_jitter()</span>
<span class="w">  </span><span class="nf">geom_jitter</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="o">+</span>
<span class="c1">#We can also add shapes to the plot. Here we added a line to show where  the EPA&#39;s guideline for unsafe levels of mercury in fish would fall. To create  this we used the geom_hline() function which simply creates a horizontal line at a y-intercept that you set. We can also adjust the color and appearance of the line with color = &#39;red&#39;.  </span>
<span class="w">  </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.46</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="o">+</span>
<span class="c1">#This allows us to relabel the x-axis</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;fish&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="c1">#This allows us to relabel the y-axis</span>
<span class="w">  </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;mercury (ug/g)&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="c1">#This allows us to title the graph</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;1998 Mercury Distribution&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="c1">#This adjusts the non-data components of the plot, so the titles, labels, background, and legends among other aspects. </span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/71d876884c042b328ea8c6b3e8a87e7bd91541335b63a531c9561e44a1390b77.png"><img alt="../_images/71d876884c042b328ea8c6b3e8a87e7bd91541335b63a531c9561e44a1390b77.png" src="../_images/71d876884c042b328ea8c6b3e8a87e7bd91541335b63a531c9561e44a1390b77.png" style="width: 600px; height: 360px;" />
</a>
</div>
</div>
<p>🧠✍️ <strong>Class question:</strong></p>
<ul class="simple">
<li><p>What does this distribution tell us about the mercury levels in the fish?</p></li>
</ul>
<section id="boxplots-distribution-of-1-variable">
<h2>Boxplots: distribution of 1 variable<a class="headerlink" href="#boxplots-distribution-of-1-variable" title="Link to this heading">#</a></h2>
<p>Next, Look back at the min, max, median, and mean values that were calculated above. Where would these values fall on this graph? Are the mean and median values above or below the level suggested by the EPA?</p>
<p>We can overlay a “boxplot” on the previous scatter plot. Boxplots are a way to show the mean, quartiles, minimum and maximum of a distribution. You can google “boxplot” to learn more.</p>
<p>Like last time, you can just run this code if you want. We want to focus on the results. However, we’ve provided comments to help you understand each line of the code, if you want.</p>
<p>If you want to customize the plot, try changing the color inside <code class="docutils literal notranslate"><span class="pre">geom_boxplot()</span></code> or <code class="docutils literal notranslate"><span class="pre">geom_hline()</span></code> to one from this <a class="reference external" href="https://r-charts.com/colors/">list</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># These lines are almost the same as the last code chunk, </span>
<span class="c1"># but we added a &#39;+&#39; at the end, to add some new pieces to the graph.</span>
<span class="nf">ggplot </span><span class="p">(</span><span class="n">fish_1998</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="s">&#39;fish&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="n">mercury</span><span class="p">))</span><span class="o">+</span>
<span class="nf">geom_jitter</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="o">+</span>
<span class="c1"># We will overlay a boxplot on the jitter plot. </span>
<span class="c1"># We can adjust its color as we did above,</span>
<span class="c1"># We use alpha, to adjust the opacity of the boxplot.</span>
<span class="c1"># This lets us see the jitter plot beneath it.</span>
<span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;dodgerblue2&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="c1"># As before, we add a line to represent the EPA&#39;s recommended safe mercury ingestion level</span>
<span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.46</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="o">+</span>
<span class="c1"># The rest of the code is the same as the last code chunk:</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;fish&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;mercury (ug/g)&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;1998 Mercury Distribution + Box Plot&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme_minimal</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/35fc47eb2974444284e686de794428be8bdc6df13b516aab3b607f4d65ecd4fb.png"><img alt="../_images/35fc47eb2974444284e686de794428be8bdc6df13b516aab3b607f4d65ecd4fb.png" src="../_images/35fc47eb2974444284e686de794428be8bdc6df13b516aab3b607f4d65ecd4fb.png" style="width: 600px; height: 360px;" />
</a>
</div>
</div>
<p>You have now seen what the mercury distribution in local fish looks like and connected it to the summary statistics that were calculated above!</p>
<p>🧠✍️ <strong>Class Questions:</strong></p>
<ul class="simple">
<li><p>From looking at this graph, are there unsafe levels of mercury in local fish?
If so, is it in most fish, or only some? Did this graph tell you anything different than the summary statistics, or did it just tell you the same information in a different way?</p></li>
<li><p>In 1998, was it safe for members of the K’avi community to eat fish from these waters?</p></li>
<li><p>How comfortable would you have been in 1998 about eating a fish that you caught?</p></li>
</ul>
</section>
<section id="scatterplots-relationship-between-2-variables">
<h2>Scatterplots: relationship between 2 variables<a class="headerlink" href="#scatterplots-relationship-between-2-variables" title="Link to this heading">#</a></h2>
<p>Mercury is known to build up in fish as they age: The oldest fish tend to have the highest levels of mercury. Older fish also tend to be bigger, so maybe if we know the relationship between fish size and fish mercury levels, that could give us useful guidance for which fish were safe to eat back in 1998.</p>
<p>We’ll make another graph of the same dataset. This time we’ll make a scatterplot of both the mercury level and the length of each fish. A scatterplot shows the data as points in two dimensions (fish length and mercury content, here).</p>
<p>Again, you can just run the code (with the green arrow), but we’ve also provided comments to help you learn how it works. Our goal here is to let you see the kings of graphs you can make in R and to help interpret the safety of the fish from 1998.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># This line defines a plot, called &#39;LengthMercury1998&#39;, as a ggplot(). </span>
<span class="c1"># The ggplot() code is a little different from the single variable boxplot.</span>
<span class="c1"># Now, we are plotting two columns of the dataset: </span>
<span class="c1"># length will be on the (horizontal) x-axis</span>
<span class="c1"># mercury will be on the (vertical) y-axis</span>
<span class="n">LengthMercury1998</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">fish_1998</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mercury</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="c1"># geom_point() makes a scatterplot.</span>
<span class="c1"># We are going to plot the data points in blue </span>
<span class="c1"># and a little bigger than the default &quot;size = 2&quot;</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;blue&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="c1"># Now we&#39;re going to write labels for the two axes, and give the graph a title</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;length (cm)&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;mercury (ug/g)&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Mercury (ug/g) vs. Length (cm) (1998)&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="c1"># As before, we will add a line to represent the EPA&#39;s recommended mercury level</span>
<span class="c1"># This time, we&#39;ll make a red dashed line.</span>
<span class="w">  </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.46</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;red&#39;</span><span class="p">)</span><span class="o">+</span>
<span class="c1"># We&#39;ll use the same theme as last time.</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span>


<span class="c1">#Because we assigned the graph a label, we have to call that label</span>
<span class="n">LengthMercury1998</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/a69ad6bd1d544b26092743b8fc2d15507eb465e0d9fcb05cb96411f89c42a3c2.png"><img alt="../_images/a69ad6bd1d544b26092743b8fc2d15507eb465e0d9fcb05cb96411f89c42a3c2.png" src="../_images/a69ad6bd1d544b26092743b8fc2d15507eb465e0d9fcb05cb96411f89c42a3c2.png" style="width: 600px; height: 360px;" />
</a>
</div>
</div>
<p>🧠✍️ <strong>Class Questions:</strong></p>
<ul class="simple">
<li><p>What does this tell us about the relationship between fish length and mercury levels?</p></li>
<li><p>Are there certain lengths of fish that have a higher amount of mercury?</p></li>
<li><p>If you caught a fish in 1998, would this graph help you decide whether the fish was safe?</p></li>
</ul>
</section>
<section id="lesson-4-recap">
<h2>Lesson 4 Recap<a class="headerlink" href="#lesson-4-recap" title="Link to this heading">#</a></h2>
<p>In Lesson 4 we learned how to:</p>
<ul class="simple">
<li><p>plot the distribution and boxplot of a single variable, mercury</p></li>
<li><p>plot a scatter plot of the relationship between two variables, mercury and fish length.</p></li>
</ul>
<p>Next we will explore another data set from a more recent survey.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "rachtorr/IndigenousEnvDataSci.github.io",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./MOD1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Mod1_pt3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lesson 3: Calculating statistics</p>
      </div>
    </a>
    <a class="right-next"
       href="Mod1_pt5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lesson 5: Put it all together to explore the updated fish survey</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplots-distribution-of-1-variable">Boxplots: distribution of 1 variable</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scatterplots-relationship-between-2-variables">Scatterplots: relationship between 2 variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lesson-4-recap">Lesson 4 Recap</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>